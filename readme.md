# Pull Request Reviewer Assignment Service

Сервис для автоматического назначения ревьюеров на Pull Request (PR) внутри команды через HTTP API.  
Реализован на Go с использованием Docker и Docker Compose.

---

## Функционал

- Создание Pull Request с автоматическим назначением до 2 ревьюеров из команды автора (активные пользователи, кроме автора)
- Переназначение ревьюера на случайного активного участника его команды
- Получение списка PR, назначенных конкретному пользователю
- Управление командами и активностью пользователей
- После `MERGED` PR нельзя изменять состав ревьюеров

---

## Структура проекта

```
.
├── Dockerfile         # сборка Go-сервиса
├── compose.yml        # docker-compose конфигурация
├── go.mod             # зависимости
├── go.sum             # контроль версий зависимостей
├── main.go            # точка входа
├── .env.example       # пример файла с переменными окружения
└── internal/          # внутренняя логика приложения
```

---

## Быстрый старт

### 1. Настройка переменных окружения

Создайте файл `.env` в корне проекта на основе `.env.example`:

```properties
# Настройки базы данных PostgreSQL
DB_USER=dbuser
DB_PASSWORD=dbpassword
DB_NAME=prdb

# Режим работы Gin (release/debug)
GIN_MODE=release
```

**Описание переменных:**
- `DB_USER` — имя пользователя PostgreSQL
- `DB_PASSWORD` — пароль пользователя PostgreSQL
- `DB_NAME` — название базы данных
- `GIN_MODE` — режим работы веб-фреймворка (используйте `release` для production, `debug` для разработки)

### 2. Сборка и запуск через Docker Compose

```bash
git clone https://github.com/RomanGhost/pull-request-avito-test.git
cd pull-request-avito-test

# сборка и запуск
docker-compose up --build
```

Сервис будет доступен на `http://localhost:8080`.

### 3. Примеры API

Примеры работы с API согласно OpenAPI спецификации `openapi.yaml`:
- Создание пользователя
- Создание команды
- Создание PR с автоматическим назначением ревьюеров
- Merge PR
- Переназначение ревьюеров

---

## Требования

- Docker 
- Docker Compose
- golang 1.24+

---

## Проблемы и решения

- **Меньше двух активных ревьюеров в команде** — назначается доступное количество
- **MERGED PR** — операция идемпотентна, повторный merge не изменяет состав ревьюеров
- **Переназначение ревьюера** — выбирается случайный активный участник его команды, исключая уже назначенных
